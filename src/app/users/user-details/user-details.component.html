<div *ngIf="!user; else detailsTpl" class="loading"></div>

<ng-template #detailsTpl>
  <p-dialog
    [(visible)]="visible"
    [modal]="true"
    [closable]="false"
    [draggable]="false"
    [resizable]="false"
    [dismissableMask]="true"
    [style]="{ width: '520px' }"
    styleClass="like-dialog"
    (onHide)="close()"
  >
    <ng-template pTemplate="header">
      <div class="dlg-header">
        <h4 class="dlg-title">{{ title }}</h4>

        <button
          type="button"
          class="close-btn"
          aria-label="Fechar"
          (click)="close()"
        >
          &times;
        </button>
      </div>
    </ng-template>

    <div class="dlg-grid">
      <div class="item span-2">
        <span class="label">Nome</span>
        <span class="value">{{ user?.name || "-" }}</span>
      </div>

      <div class="item">
        <span class="label">Telefone</span>
        <span class="value">{{ user?.telephone || "-" }}</span>
      </div>

      <div class="item span-2">
        <span class="label">Email</span>
        <span class="value">{{ user?.email || "-" }}</span>
      </div>

      <div class="item">
        <span class="label">Ativo</span>
        <span class="value">{{ getActiveLabel(user?.active) }}</span>
      </div>

      <div class="item">
        <span class="label">Data cadastro</span>
        <span class="value">{{
          user?.date ? (user?.date | date: "dd/MM/yyyy") : "-"
        }}</span>
      </div>

      <div class="item span-2">
        <span class="label">Endereço</span>
        <span class="value">{{ user?.address || "-" }}</span>
      </div>

      <div class="item span-2">
        <span class="label">Perfis</span>

        <div class="roles" *ngIf="user?.roles?.length; else noRolesTpl">
          <span class="role-chip" *ngFor="let r of user?.roles">
            {{ stripRolePrefix(r?.authority) }}
          </span>
        </div>

        <ng-template #noRolesTpl>
          <span class="value">-</span>
        </ng-template>
      </div>

      <div class="photo span-2">
        <img
          [src]="getPhotoUrl(user?.photo) || 'assets/images/sem-foto.jpg'"
          alt="Foto do usuário"
          (error)="$any($event.target).src = 'assets/images/sem-foto.jpg'"
        />
        <small class="hint" *ngIf="!user?.photo">Sem foto</small>
      </div>
    </div>
  </p-dialog>
</ng-template>
